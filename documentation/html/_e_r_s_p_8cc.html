<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>processEEG: /Users/vinay/Google Drive/Science/Research/Morlets/ERSP.cc File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">processEEG
   </div>
   <div id="projectbrief">A highly optimized program for producing the Event Related Spectral Pertubation from EEG signals.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_0ef0b1eca7dc23e7f5d00d30e05d07f9.html">Morlets</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ERSP.cc File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This file contains all of the function required to generate the Event Related Spectral Pertubation of EEG signals.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="process_e_e_g_8h_source.html">processEEG.h</a>&quot;</code><br />
<code>#include &lt;gsl/gsl_statistics.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa014a2e424ce6a16f9c9984422deb2cf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_e_r_s_p_8cc.html#aa014a2e424ce6a16f9c9984422deb2cf">RemoveBaseline</a> (double *pre_stimulus, double *pre_baseline_array, const int n, const int J, const int sampling_frequency, double *output)</td></tr>
<tr class="memdesc:aa014a2e424ce6a16f9c9984422deb2cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">A function that removes the pre stimulus noise found in EEG signals.  <a href="#aa014a2e424ce6a16f9c9984422deb2cf">More...</a><br /></td></tr>
<tr class="separator:aa014a2e424ce6a16f9c9984422deb2cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac62979f131d715929fee642852d92469"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_e_r_s_p_8cc.html#ac62979f131d715929fee642852d92469">FrequencyMultiply</a> (const fftw_complex *fft_data, const int data_size, const double scale, const double dw, fftw_complex *filter_convolution)</td></tr>
<tr class="memdesc:ac62979f131d715929fee642852d92469"><td class="mdescLeft">&#160;</td><td class="mdescRight">Multiples the signal with the wavelet at a specific scale in the frequency domain.  <a href="#ac62979f131d715929fee642852d92469">More...</a><br /></td></tr>
<tr class="separator:ac62979f131d715929fee642852d92469"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a580cbd5e5094a8596715a0f5148a153c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a580cbd5e5094a8596715a0f5148a153c"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>PopulateDataArray</b> (double *input_data, const int data_size, const int trial_number, const int padded_size, const int padding_type, fftw_complex *output_data)</td></tr>
<tr class="separator:a580cbd5e5094a8596715a0f5148a153c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd3b9cec11d036982bf9ab02c05c05b2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_e_r_s_p_8cc.html#afd3b9cec11d036982bf9ab02c05c05b2">ERSP</a> (double *raw_data, double *scales, const int sampling_frequency, const int n, const int J, int const trials, const int padding_type, double *output)</td></tr>
<tr class="separator:afd3b9cec11d036982bf9ab02c05c05b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a80fcc210f38e5dd27c37426c0a5b16"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_e_r_s_p_8cc.html#a0a80fcc210f38e5dd27c37426c0a5b16">Generate_FFTW_Wisdom</a> (int padded_size)</td></tr>
<tr class="memdesc:a0a80fcc210f38e5dd27c37426c0a5b16"><td class="mdescLeft">&#160;</td><td class="mdescRight">Analyzes the size of the FFTW arrays and generates the optimal plan.  <a href="#a0a80fcc210f38e5dd27c37426c0a5b16">More...</a><br /></td></tr>
<tr class="separator:a0a80fcc210f38e5dd27c37426c0a5b16"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file contains all of the function required to generate the Event Related Spectral Pertubation of EEG signals. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="afd3b9cec11d036982bf9ab02c05c05b2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ERSP </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>raw_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>scales</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>sampling_frequency</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>J</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int const&#160;</td>
          <td class="paramname"><em>trials</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>padding_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">raw_data</td><td>A trials * n array containing the data to be analyzed </td></tr>
    <tr><td class="paramname">scales</td><td>A 1 x J array of the scales that the wavelets will be analyzed in </td></tr>
    <tr><td class="paramname">sampling_frequency</td><td>The frequency that the data was sampled in </td></tr>
    <tr><td class="paramname">n</td><td>The numer of samples in each data set </td></tr>
    <tr><td class="paramname">J</td><td>The number of scales to be analyzed </td></tr>
    <tr><td class="paramname">trials</td><td>The number of trials conducted for the ERSP </td></tr>
    <tr><td class="paramname">output</td><td>A n x J array with the resultant ERSP from all of the trials.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0</dd></dl>
<p>This function conducts the Event Related Spectral Pertubation of the given data set <em>raw_data</em>. It follows the method outlined by the paper: "Single-trial normalization for event-related spectral decomposition reduces sensitivity to noisy trials".</p>
<p>This function uses the Continuous Wavelet Transform to generate the multi-resolution analysis of the given data.</p>
<p>This function is multi-threaded.</p>
<p>This function deals a lot with Fast Fourier Transforms, and can be optimized by using the Generate_FFTW_Wisedom() function. If no wisdom is provided, an approximate FFT algorithm will be used.</p>
<p>The variable raw_data must contain all of the data for each trial.</p>
<p>raw_data, scales, and output must be pre-allocated. </p>

</div>
</div>
<a class="anchor" id="ac62979f131d715929fee642852d92469"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int FrequencyMultiply </td>
          <td>(</td>
          <td class="paramtype">const fftw_complex *&#160;</td>
          <td class="paramname"><em>fft_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>data_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>dw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&#160;</td>
          <td class="paramname"><em>filter_convolution</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Multiples the signal with the wavelet at a specific scale in the frequency domain. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fft_data</td><td>A fftw_complex * data_size array with the signal data in the frequency domain. </td></tr>
    <tr><td class="paramname">data_size</td><td>The size of the data array </td></tr>
    <tr><td class="paramname">scale</td><td>THe scale of the wavelet that will be multiplied with the signal array </td></tr>
    <tr><td class="paramname">dw</td><td>THe discrete increment in the frequency domain for the wavelet </td></tr>
    <tr><td class="paramname">filter_convolution</td><td>A fftw_complex * data_size array with the resulted multiplication</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0</dd></dl>
<p>This function mutliples the contents of fft_data with with the wavelet specified by the variable <em>scale</em>. It stores the result in filter_convolution.</p>
<p>All arrays must be pre allocated. </p>

</div>
</div>
<a class="anchor" id="a0a80fcc210f38e5dd27c37426c0a5b16"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Generate_FFTW_Wisdom </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>padded_size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Analyzes the size of the FFTW arrays and generates the optimal plan. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">padded_size</td><td>The size of the FFT arrays.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 If successful </dd>
<dd>
1 if unsuccessful</dd></dl>
<p>This function can be used to optimize FFTW. This function will try to find the fastest FFT method based on the size of the array, and will store this information as "FFTW_plan.wise".</p>
<p>This function does not need to be used, but it can significantly improve performance if it is. </p>

</div>
</div>
<a class="anchor" id="aa014a2e424ce6a16f9c9984422deb2cf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RemoveBaseline </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>pre_stimulus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>pre_baseline_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>J</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A function that removes the pre stimulus noise found in EEG signals. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pre_stimulus</td><td>A 1 x m array to store the pre stimulus data </td></tr>
    <tr><td class="paramname">pre_baseline_array</td><td>An n x J array of the data that must be modified </td></tr>
    <tr><td class="paramname">n</td><td>The number of samples in the entire data array </td></tr>
    <tr><td class="paramname">J</td><td>The number of scales that were used </td></tr>
    <tr><td class="paramname">m</td><td>The size of the array before the stimulus </td></tr>
    <tr><td class="paramname">output</td><td>An n x J array that the function stores the result in.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0</dd></dl>
<p>This function follows the method outlined in the paper "Single-trial normalization for event-related spectral decomposition reduces sensitivity to noisy trials".</p>
<p>The function will remove the baseline observed in in the pre stimulus by computing the z score on only the information before the stimulus. The variable <em>m</em> is the number of samples before the stimulus was introduced.</p>
<p>All arrays must be pre allocated. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
