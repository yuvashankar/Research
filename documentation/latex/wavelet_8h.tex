\hypertarget{wavelet_8h}{}\section{/\+Users/vinay/\+Google Drive/\+Science/\+Research/include/wavelet.h File Reference}
\label{wavelet_8h}\index{/\+Users/vinay/\+Google Drive/\+Science/\+Research/include/wavelet.\+h@{/\+Users/vinay/\+Google Drive/\+Science/\+Research/include/wavelet.\+h}}


The supporting header file for generating the Continuous Wavelet Transform.  


{\ttfamily \#include $<$stdio.\+h$>$}\\*
{\ttfamily \#include $<$stdlib.\+h$>$}\\*
{\ttfamily \#include $<$assert.\+h$>$}\\*
{\ttfamily \#include $<$string.\+h$>$}\\*
{\ttfamily \#include $<$math.\+h$>$}\\*
{\ttfamily \#include $<$fftw3.\+h$>$}\\*
{\ttfamily \#include $<$omp.\+h$>$}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\hypertarget{wavelet_8h_a5e48d65e5914b5b646fed116dac9b9d6}{}\#define \hyperlink{wavelet_8h_a5e48d65e5914b5b646fed116dac9b9d6}{Q\+U\+A\+D\+\_\+\+R\+O\+O\+T\+\_\+\+P\+I}~0.\+7511255444649425\label{wavelet_8h_a5e48d65e5914b5b646fed116dac9b9d6}

\begin{DoxyCompactList}\small\item\em the quad root of pi ( $ \pi^{-0.25} $) computed to machine precision \end{DoxyCompactList}\item 
\#define \hyperlink{wavelet_8h_a548f13fd7e1be5728f3e0985d8474287}{C\+\_\+\+S\+I\+G\+M\+A}~1.\+0000000000018794
\begin{DoxyCompactList}\small\item\em A constant needed to compute the Morlet Wavelet precalculated to machine precision. \end{DoxyCompactList}\item 
\#define \hyperlink{wavelet_8h_a409924d27c555a15d03e0f529e855fa1}{K\+\_\+\+S\+I\+G\+M\+A}~1.\+5229979744712628e-\/08
\begin{DoxyCompactList}\small\item\em A constant needed to compute the Morlet Wavelet precalculated to machine eps. \end{DoxyCompactList}\item 
\hypertarget{wavelet_8h_abd064011ce1434a529eb4d8b1c4a6039}{}\#define \hyperlink{wavelet_8h_abd064011ce1434a529eb4d8b1c4a6039}{W\+\_\+0}~6.\+0\label{wavelet_8h_abd064011ce1434a529eb4d8b1c4a6039}

\begin{DoxyCompactList}\small\item\em The fundamental frequency of the Morlet Wavelet. \end{DoxyCompactList}\item 
\hypertarget{wavelet_8h_af4c140412d22ee15765eb416797717a1}{}\#define \hyperlink{wavelet_8h_af4c140412d22ee15765eb416797717a1}{W\+\_\+0\+\_\+2}~36.\+0\label{wavelet_8h_af4c140412d22ee15765eb416797717a1}

\begin{DoxyCompactList}\small\item\em The fundamental frequency of the Morlet Wavelet squared. \end{DoxyCompactList}\item 
\#define \hyperlink{wavelet_8h_ab7acaac3ed40230536a8ded3672b64b4}{D\+\_\+\+J}~0.\+125
\item 
\#define \hyperlink{wavelet_8h_a01bbb3ee3652091a5d42d531011b3869}{P\+A\+D\+\_\+\+F\+L\+A\+G}~1
\begin{DoxyCompactList}\small\item\em The type of padding specified for the Continuous Wavelet Transform. \end{DoxyCompactList}\item 
\hypertarget{wavelet_8h_a30588c5eca7c9cb6ebba02a0236f0119}{}\#define {\bfseries F\+S}~2048\label{wavelet_8h_a30588c5eca7c9cb6ebba02a0236f0119}

\item 
\hypertarget{wavelet_8h_af471b81801bd23de233b0c589e5c1392}{}\#define \hyperlink{wavelet_8h_af471b81801bd23de233b0c589e5c1392}{D\+T}~1.\+0/F\+S\label{wavelet_8h_af471b81801bd23de233b0c589e5c1392}

\begin{DoxyCompactList}\small\item\em $ \delta t = \frac{1}{f_s} $ \end{DoxyCompactList}\item 
\hypertarget{wavelet_8h_a8c18ad4a74b8798db7107aaa0f4266c0}{}\#define \hyperlink{wavelet_8h_a8c18ad4a74b8798db7107aaa0f4266c0}{S0}~2.\+0 $\ast$ \hyperlink{wavelet_8h_af471b81801bd23de233b0c589e5c1392}{D\+T}\label{wavelet_8h_a8c18ad4a74b8798db7107aaa0f4266c0}

\begin{DoxyCompactList}\small\item\em the lowest scale that can be used to compute the C\+W\+T $ s_0 = 2 \delta t $ \end{DoxyCompactList}\item 
\hypertarget{wavelet_8h_a1b04ec1cde4d3032f558ed8ad05930a4}{}\#define {\bfseries F\+R\+E\+Q}~16.\+0\label{wavelet_8h_a1b04ec1cde4d3032f558ed8ad05930a4}

\item 
\hypertarget{wavelet_8h_af55149bc1f05cf18af067a302e31e3f9}{}\#define {\bfseries D\+A\+T\+A\+\_\+\+S\+I\+Z\+E}~6144\label{wavelet_8h_af55149bc1f05cf18af067a302e31e3f9}

\item 
\hypertarget{wavelet_8h_ad4fda822ab4300f2d55d53fa81dacb44}{}\#define \hyperlink{wavelet_8h_ad4fda822ab4300f2d55d53fa81dacb44}{M\+A\+X\+\_\+\+F\+R\+E\+Q\+U\+E\+N\+C\+Y}~512.\+0\label{wavelet_8h_ad4fda822ab4300f2d55d53fa81dacb44}

\begin{DoxyCompactList}\small\item\em The maximum frequency that will be analyzed. \end{DoxyCompactList}\item 
\hypertarget{wavelet_8h_a3ad4d776137bc1c3306fcfa436a05620}{}\#define \hyperlink{wavelet_8h_a3ad4d776137bc1c3306fcfa436a05620}{M\+I\+N\+\_\+\+F\+R\+E\+Q\+U\+E\+N\+C\+Y}~0.\+5\label{wavelet_8h_a3ad4d776137bc1c3306fcfa436a05620}

\begin{DoxyCompactList}\small\item\em The minimum frequency that will be analyzed. \end{DoxyCompactList}\item 
\hypertarget{wavelet_8h_a87f68e96fb938eddc39ad1f19d923a96}{}\#define {\bfseries M\+A\+X\+\_\+\+D\+A\+T\+A\+\_\+\+S\+I\+Z\+E}~10000000\label{wavelet_8h_a87f68e96fb938eddc39ad1f19d923a96}

\item 
\hypertarget{wavelet_8h_a00338acc4b2e1c7fa30d66ead5220a9d}{}\#define {\bfseries M\+I\+N\+\_\+\+I}~\hyperlink{wavelet_8h_a55e74326081d3d6dca9cca7e7063f563}{F\+R\+E\+Q\+\_\+\+T\+O\+\_\+\+S\+C\+A\+L\+E}(\hyperlink{wavelet_8h_ad4fda822ab4300f2d55d53fa81dacb44}{M\+A\+X\+\_\+\+F\+R\+E\+Q\+U\+E\+N\+C\+Y})\label{wavelet_8h_a00338acc4b2e1c7fa30d66ead5220a9d}

\item 
\hypertarget{wavelet_8h_a76ff73fcfb08be66dba47d63ee0eb842}{}\#define {\bfseries M\+A\+X\+\_\+\+I}~\hyperlink{wavelet_8h_a55e74326081d3d6dca9cca7e7063f563}{F\+R\+E\+Q\+\_\+\+T\+O\+\_\+\+S\+C\+A\+L\+E}(\hyperlink{wavelet_8h_a3ad4d776137bc1c3306fcfa436a05620}{M\+I\+N\+\_\+\+F\+R\+E\+Q\+U\+E\+N\+C\+Y})\label{wavelet_8h_a76ff73fcfb08be66dba47d63ee0eb842}

\item 
\hypertarget{wavelet_8h_a55e74326081d3d6dca9cca7e7063f563}{}\#define \hyperlink{wavelet_8h_a55e74326081d3d6dca9cca7e7063f563}{F\+R\+E\+Q\+\_\+\+T\+O\+\_\+\+S\+C\+A\+L\+E}(x)~floor( ( log2( (\hyperlink{wavelet_8h_abd064011ce1434a529eb4d8b1c4a6039}{W\+\_\+0}) / (\hyperlink{wavelet_8h_a8c18ad4a74b8798db7107aaa0f4266c0}{S0} $\ast$ 2 $\ast$ M\+\_\+\+P\+I $\ast$ x) ) )/\hyperlink{wavelet_8h_ab7acaac3ed40230536a8ded3672b64b4}{D\+\_\+\+J})\label{wavelet_8h_a55e74326081d3d6dca9cca7e7063f563}

\begin{DoxyCompactList}\small\item\em Converts a given frequency {\itshape x} to a scale, handy for debugging. Note the scale is divided into sub octaves. \end{DoxyCompactList}\item 
\hypertarget{wavelet_8h_ab7d5d9582bc79ef9b90f0dd7cb876f2e}{}\#define \hyperlink{wavelet_8h_ab7d5d9582bc79ef9b90f0dd7cb876f2e}{S\+C\+A\+L\+E\+\_\+\+T\+O\+\_\+\+F\+R\+E\+Q}(x)~(\hyperlink{wavelet_8h_abd064011ce1434a529eb4d8b1c4a6039}{W\+\_\+0})/(x $\ast$ 2 $\ast$ M\+\_\+\+P\+I)\label{wavelet_8h_ab7d5d9582bc79ef9b90f0dd7cb876f2e}

\begin{DoxyCompactList}\small\item\em Converts a given scale {\itshape x} to its corrosponding frequency. \end{DoxyCompactList}\item 
\hypertarget{wavelet_8h_a5b2902836360750d67596b282a199099}{}\#define \hyperlink{wavelet_8h_a5b2902836360750d67596b282a199099}{M\+A\+G\+N\+I\+T\+U\+D\+E}(x,  y)~(x $\ast$ x) + (y $\ast$ y)\label{wavelet_8h_a5b2902836360750d67596b282a199099}

\begin{DoxyCompactList}\small\item\em Computes the 2-\/ norm or the x $^\wedge$ 2 + y $^\wedge$ 2, of {\itshape x} and {\itshape y}. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{wavelet_8h_a7f77d41dda595606800244954e79daad}{Fill\+Data} (double $\ast$data)
\begin{DoxyCompactList}\small\item\em Populates the input data array with a 3 sparse sine waves. \end{DoxyCompactList}\item 
void \hyperlink{wavelet_8h_ab48098090bc3958e58e44ebec4a63f52}{Test\+Cases} (double $\ast$data, const int flag)
\begin{DoxyCompactList}\small\item\em Generates a suite of test case data for wavelet analysis. \end{DoxyCompactList}\item 
int \hyperlink{wavelet_8h_aea1698ec0444b6a49c195c64c23dd2d5}{Read\+File} (double data\mbox{[}$\,$\mbox{]}, char filename\mbox{[}$\,$\mbox{]})
\item 
int \hyperlink{wavelet_8h_a523cfb0453d4d7201a7ecf209f951ad5}{Write\+File} (const double $\ast$data, const double $\ast$frequency, const int x, const int y, const char $\ast$filename)
\begin{DoxyCompactList}\small\item\em A function that writes the Wavelet Results to the disk. \end{DoxyCompactList}\item 
int \hyperlink{wavelet_8h_a03987d098ad4cf62c98501cf41969731}{Write\+Debug} (const double $\ast$data, const int length, const char $\ast$filename)
\begin{DoxyCompactList}\small\item\em A function that writes a 1 -\/ d matrix into a log file. \end{DoxyCompactList}\item 
int \hyperlink{wavelet_8h_afd3b9cec11d036982bf9ab02c05c05b2}{E\+R\+S\+P} (double $\ast$raw\+\_\+data, double $\ast$scales, const int sampling\+\_\+frequency, const int n, const int J, int const trials, const int padding\+\_\+type, double $\ast$output)
\item 
\hypertarget{wavelet_8h_aa7228028715fcf3300384801fad4ab11}{}void {\bfseries Plot} (double $\ast$data, double $\ast$periods, int num\+\_\+x, int num\+\_\+y)\label{wavelet_8h_aa7228028715fcf3300384801fad4ab11}

\item 
double \hyperlink{wavelet_8h_abb362e505564f730823d539a93d31de2}{Complete\+Fourier\+Morlet} (const double w, const double scale)
\begin{DoxyCompactList}\small\item\em Computes the Morlet Wavelet in the frequency domain. \end{DoxyCompactList}\item 
int \hyperlink{wavelet_8h_ad5997a1e04e6726779fded8881045b7d}{Wavelet} (double $\ast$raw\+\_\+data, double $\ast$scales, double sampling\+\_\+frequency, int n, int J, double $\ast$result)
\begin{DoxyCompactList}\small\item\em A function that computes the Continuous Wavelet Transform for the data given in {\itshape raw\+\_\+data}. \end{DoxyCompactList}\item 
void \hyperlink{wavelet_8h_aa3dfcb0be818bb8c79f0b034ea627ac0}{Clean\+Data} (double $\ast$data, double n)
\item 
double $\ast$ \hyperlink{wavelet_8h_a1d3f7b9f0f7a720314d1dec62efadabf}{Generate\+Scales} (const double minimum\+\_\+frequency, const double maximum\+\_\+frequency, const double s\+\_\+0)
\begin{DoxyCompactList}\small\item\em This function generates the scales that will be used in the Continuous Wavelet Transform. \end{DoxyCompactList}\item 
double $\ast$ \hyperlink{wavelet_8h_a741383f7877b85635e4b9eaad57a11a1}{Identify\+Frequencies} (double $\ast$scales, int count)
\begin{DoxyCompactList}\small\item\em Compute the corrosponding frequency to scales used. \end{DoxyCompactList}\item 
\hypertarget{wavelet_8h_ab60ecb0f50f9df5063abe5dad801723b}{}void {\bfseries Convolute} (double $\ast$data, double $\ast$con\+Window, double $\ast$complex\+Window, double con\+Size, double $\ast$result, double $\ast$complex\+Result)\label{wavelet_8h_ab60ecb0f50f9df5063abe5dad801723b}

\item 
int \hyperlink{wavelet_8h_ab7b8e80239255476283ace667b26e46b}{Calculate\+Padding\+Size} (const int array\+\_\+size, const int pad\+\_\+flag)
\begin{DoxyCompactList}\small\item\em Calculates the size that the padded array should be. \end{DoxyCompactList}\item 
int \hyperlink{wavelet_8h_a0a80fcc210f38e5dd27c37426c0a5b16}{Generate\+\_\+\+F\+F\+T\+W\+\_\+\+Wisdom} (int padded\+\_\+size)
\begin{DoxyCompactList}\small\item\em Analyzes the size of the F\+F\+T\+W arrays and generates the optimal plan. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
The supporting header file for generating the Continuous Wavelet Transform. 



\subsection{Macro Definition Documentation}
\hypertarget{wavelet_8h_a548f13fd7e1be5728f3e0985d8474287}{}\index{wavelet.\+h@{wavelet.\+h}!C\+\_\+\+S\+I\+G\+M\+A@{C\+\_\+\+S\+I\+G\+M\+A}}
\index{C\+\_\+\+S\+I\+G\+M\+A@{C\+\_\+\+S\+I\+G\+M\+A}!wavelet.\+h@{wavelet.\+h}}
\subsubsection[{C\+\_\+\+S\+I\+G\+M\+A}]{\setlength{\rightskip}{0pt plus 5cm}C\+\_\+\+S\+I\+G\+M\+A~1.\+0000000000018794}\label{wavelet_8h_a548f13fd7e1be5728f3e0985d8474287}


A constant needed to compute the Morlet Wavelet precalculated to machine precision. 

\[ C_\sigma = (1 + e^{-\sigma^2} - 2e^{-\frac{3\sigma^2}{4}})^{-\frac{1}{2}} \] \hypertarget{wavelet_8h_ab7acaac3ed40230536a8ded3672b64b4}{}\index{wavelet.\+h@{wavelet.\+h}!D\+\_\+\+J@{D\+\_\+\+J}}
\index{D\+\_\+\+J@{D\+\_\+\+J}!wavelet.\+h@{wavelet.\+h}}
\subsubsection[{D\+\_\+\+J}]{\setlength{\rightskip}{0pt plus 5cm}D\+\_\+\+J~0.\+125}\label{wavelet_8h_ab7acaac3ed40230536a8ded3672b64b4}
The amount of \char`\"{}sub octaves\char`\"{} or sub scales inbetween the major scales that will be used. The lower the number, the higher the resolution of the result. \hypertarget{wavelet_8h_a409924d27c555a15d03e0f529e855fa1}{}\index{wavelet.\+h@{wavelet.\+h}!K\+\_\+\+S\+I\+G\+M\+A@{K\+\_\+\+S\+I\+G\+M\+A}}
\index{K\+\_\+\+S\+I\+G\+M\+A@{K\+\_\+\+S\+I\+G\+M\+A}!wavelet.\+h@{wavelet.\+h}}
\subsubsection[{K\+\_\+\+S\+I\+G\+M\+A}]{\setlength{\rightskip}{0pt plus 5cm}K\+\_\+\+S\+I\+G\+M\+A~1.\+5229979744712628e-\/08}\label{wavelet_8h_a409924d27c555a15d03e0f529e855fa1}


A constant needed to compute the Morlet Wavelet precalculated to machine eps. 

\[ \kappa_\sigma = e^{-\frac{\sigma^2}{2}} \] \hypertarget{wavelet_8h_a01bbb3ee3652091a5d42d531011b3869}{}\index{wavelet.\+h@{wavelet.\+h}!P\+A\+D\+\_\+\+F\+L\+A\+G@{P\+A\+D\+\_\+\+F\+L\+A\+G}}
\index{P\+A\+D\+\_\+\+F\+L\+A\+G@{P\+A\+D\+\_\+\+F\+L\+A\+G}!wavelet.\+h@{wavelet.\+h}}
\subsubsection[{P\+A\+D\+\_\+\+F\+L\+A\+G}]{\setlength{\rightskip}{0pt plus 5cm}P\+A\+D\+\_\+\+F\+L\+A\+G~1}\label{wavelet_8h_a01bbb3ee3652091a5d42d531011b3869}


The type of padding specified for the Continuous Wavelet Transform. 

The Continuous Wavelet Transform uses the Fast Fourier Transform. It is sometimes efficient to add additional values to the edge of the data array to improve the speed of the F\+F\+T. This method is commonly called padding the data array. This variable determins the type of padding that will be used to assist the Fast Fourier Transform. T\+He padding options are\+:

0 -\/ No Padding
\begin{DoxyItemize}
\item The array will be analyzed with no padding.
\end{DoxyItemize}

1 -\/ Zero Padding
\begin{DoxyItemize}
\item The size of the array will be enlarged to the closest power of two and zeros will be added to the end.
\end{DoxyItemize}

2 -\/ Ramp Padding
\begin{DoxyItemize}
\item The array will be doubled in size, and the signal will be ramped up and ramped down to gradually.
\end{DoxyItemize}

If none of these are specified, the array is not padded by default. 

\subsection{Function Documentation}
\hypertarget{wavelet_8h_ab7b8e80239255476283ace667b26e46b}{}\index{wavelet.\+h@{wavelet.\+h}!Calculate\+Padding\+Size@{Calculate\+Padding\+Size}}
\index{Calculate\+Padding\+Size@{Calculate\+Padding\+Size}!wavelet.\+h@{wavelet.\+h}}
\subsubsection[{Calculate\+Padding\+Size(const int array\+\_\+size, const int pad\+\_\+flag)}]{\setlength{\rightskip}{0pt plus 5cm}int Calculate\+Padding\+Size (
\begin{DoxyParamCaption}
\item[{const int}]{array\+\_\+size, }
\item[{const int}]{pad\+\_\+flag}
\end{DoxyParamCaption}
)}\label{wavelet_8h_ab7b8e80239255476283ace667b26e46b}


Calculates the size that the padded array should be. 


\begin{DoxyParams}{Parameters}
{\em array\+\_\+size} & The cardinal or size of the signal sample \\
\hline
{\em pad\+\_\+flag} & The type of padding required\+: see P\+A\+D\+\_\+\+F\+L\+A\+G\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
paadded\+\_\+size The cardinal or size that the padded array should be
\end{DoxyReturn}
This function computes the size of the padded array depending on the type of padding specified. It takes the size of the data array, and type of pad, and returns how large the padded array should be. \hypertarget{wavelet_8h_aa3dfcb0be818bb8c79f0b034ea627ac0}{}\index{wavelet.\+h@{wavelet.\+h}!Clean\+Data@{Clean\+Data}}
\index{Clean\+Data@{Clean\+Data}!wavelet.\+h@{wavelet.\+h}}
\subsubsection[{Clean\+Data(double $\ast$data, double n)}]{\setlength{\rightskip}{0pt plus 5cm}void Clean\+Data (
\begin{DoxyParamCaption}
\item[{double $\ast$}]{data, }
\item[{double}]{n}
\end{DoxyParamCaption}
)}\label{wavelet_8h_aa3dfcb0be818bb8c79f0b034ea627ac0}

\begin{DoxyParams}{Parameters}
{\em data} & An 1 x n array with the data to be cleaned \\
\hline
{\em n} & The size of the data array.\\
\hline
\end{DoxyParams}
Takes a 1 x n array and preforms the Z-\/\+Score Calculation The array data will be rewritten \hypertarget{wavelet_8h_abb362e505564f730823d539a93d31de2}{}\index{wavelet.\+h@{wavelet.\+h}!Complete\+Fourier\+Morlet@{Complete\+Fourier\+Morlet}}
\index{Complete\+Fourier\+Morlet@{Complete\+Fourier\+Morlet}!wavelet.\+h@{wavelet.\+h}}
\subsubsection[{Complete\+Fourier\+Morlet(const double w, const double scale)}]{\setlength{\rightskip}{0pt plus 5cm}double Complete\+Fourier\+Morlet (
\begin{DoxyParamCaption}
\item[{double}]{w, }
\item[{double}]{scale}
\end{DoxyParamCaption}
)}\label{wavelet_8h_abb362e505564f730823d539a93d31de2}


Computes the Morlet Wavelet in the frequency domain. 


\begin{DoxyParams}{Parameters}
{\em w} & \\
\hline
{\em scale} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
morlet
\end{DoxyReturn}
This function generates the Morlet Wavelet in the frequency domain normalized by the scale.

The formula computed is \[ \hat{\Psi}_\sigma(\omega) = c_\sigma \pi^{-\frac{1}{4}}(e^{-\frac{1}{2}(\sigma - \omega)^2} - \kappa_\sigma e^{-\frac{1}{2} \omega^2}) \] \hypertarget{wavelet_8h_afd3b9cec11d036982bf9ab02c05c05b2}{}\index{wavelet.\+h@{wavelet.\+h}!E\+R\+S\+P@{E\+R\+S\+P}}
\index{E\+R\+S\+P@{E\+R\+S\+P}!wavelet.\+h@{wavelet.\+h}}
\subsubsection[{E\+R\+S\+P(double $\ast$raw\+\_\+data, double $\ast$scales, const int sampling\+\_\+frequency, const int n, const int J, int const trials, const int padding\+\_\+type, double $\ast$output)}]{\setlength{\rightskip}{0pt plus 5cm}int E\+R\+S\+P (
\begin{DoxyParamCaption}
\item[{double $\ast$}]{raw\+\_\+data, }
\item[{double $\ast$}]{scales, }
\item[{const int}]{sampling\+\_\+frequency, }
\item[{const int}]{n, }
\item[{const int}]{J, }
\item[{int const}]{trials, }
\item[{const int}]{padding\+\_\+type, }
\item[{double $\ast$}]{output}
\end{DoxyParamCaption}
)}\label{wavelet_8h_afd3b9cec11d036982bf9ab02c05c05b2}

\begin{DoxyParams}{Parameters}
{\em raw\+\_\+data} & A trials $\ast$ n array containing the data to be analyzed \\
\hline
{\em scales} & A 1 x J array of the scales that the wavelets will be analyzed in \\
\hline
{\em sampling\+\_\+frequency} & The frequency that the data was sampled in \\
\hline
{\em n} & The numer of samples in each data set \\
\hline
{\em J} & The number of scales to be analyzed \\
\hline
{\em trials} & The number of trials conducted for the E\+R\+S\+P \\
\hline
{\em output} & A n x J array with the resultant E\+R\+S\+P from all of the trials.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
This function conducts the Event Related Spectral Pertubation of the given data set {\itshape raw\+\_\+data}. It follows the method outlined by the paper\+: \char`\"{}\+Single-\/trial normalization for event-\/related spectral decomposition reduces sensitivity to noisy trials\char`\"{}.

This function uses the Continuous Wavelet Transform to generate the multi-\/resolution analysis of the given data.

This function is multi-\/threaded.

This function deals a lot with Fast Fourier Transforms, and can be optimized by using the Generate\+\_\+\+F\+F\+T\+W\+\_\+\+Wisedom() function. If no wisdom is provided, an approximate F\+F\+T algorithm will be used.

The variable raw\+\_\+data must contain all of the data for each trial.

raw\+\_\+data, scales, and output must be pre-\/allocated. \hypertarget{wavelet_8h_a7f77d41dda595606800244954e79daad}{}\index{wavelet.\+h@{wavelet.\+h}!Fill\+Data@{Fill\+Data}}
\index{Fill\+Data@{Fill\+Data}!wavelet.\+h@{wavelet.\+h}}
\subsubsection[{Fill\+Data(double $\ast$data)}]{\setlength{\rightskip}{0pt plus 5cm}void Fill\+Data (
\begin{DoxyParamCaption}
\item[{double $\ast$}]{data}
\end{DoxyParamCaption}
)}\label{wavelet_8h_a7f77d41dda595606800244954e79daad}


Populates the input data array with a 3 sparse sine waves. 


\begin{DoxyParams}{Parameters}
{\em data} & A 1 -\/ dimentional block of memory that will be overwritten.\\
\hline
\end{DoxyParams}
Similar to \hyperlink{wavelet_8cc_ab48098090bc3958e58e44ebec4a63f52}{Test\+Cases()} Sine Wave Sample

Sine Wave Sample

Sine Wave Sample \hypertarget{wavelet_8h_a0a80fcc210f38e5dd27c37426c0a5b16}{}\index{wavelet.\+h@{wavelet.\+h}!Generate\+\_\+\+F\+F\+T\+W\+\_\+\+Wisdom@{Generate\+\_\+\+F\+F\+T\+W\+\_\+\+Wisdom}}
\index{Generate\+\_\+\+F\+F\+T\+W\+\_\+\+Wisdom@{Generate\+\_\+\+F\+F\+T\+W\+\_\+\+Wisdom}!wavelet.\+h@{wavelet.\+h}}
\subsubsection[{Generate\+\_\+\+F\+F\+T\+W\+\_\+\+Wisdom(int padded\+\_\+size)}]{\setlength{\rightskip}{0pt plus 5cm}int Generate\+\_\+\+F\+F\+T\+W\+\_\+\+Wisdom (
\begin{DoxyParamCaption}
\item[{int}]{padded\+\_\+size}
\end{DoxyParamCaption}
)}\label{wavelet_8h_a0a80fcc210f38e5dd27c37426c0a5b16}


Analyzes the size of the F\+F\+T\+W arrays and generates the optimal plan. 


\begin{DoxyParams}{Parameters}
{\em padded\+\_\+size} & The size of the F\+F\+T arrays.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 If successful 

1 if unsuccessful
\end{DoxyReturn}
This function can be used to optimize F\+F\+T\+W. This function will try to find the fastest F\+F\+T method based on the size of the array, and will store this information as \char`\"{}\+F\+F\+T\+W\+\_\+plan.\+wise\char`\"{}.

This function does not need to be used, but it can significantly improve performance if it is. \hypertarget{wavelet_8h_a1d3f7b9f0f7a720314d1dec62efadabf}{}\index{wavelet.\+h@{wavelet.\+h}!Generate\+Scales@{Generate\+Scales}}
\index{Generate\+Scales@{Generate\+Scales}!wavelet.\+h@{wavelet.\+h}}
\subsubsection[{Generate\+Scales(const double minimum\+\_\+frequency, const double maximum\+\_\+frequency, const double s\+\_\+0)}]{\setlength{\rightskip}{0pt plus 5cm}double $\ast$ Generate\+Scales (
\begin{DoxyParamCaption}
\item[{const double}]{minimum\+\_\+frequency, }
\item[{const double}]{maximum\+\_\+frequency, }
\item[{const double}]{s\+\_\+0}
\end{DoxyParamCaption}
)}\label{wavelet_8h_a1d3f7b9f0f7a720314d1dec62efadabf}


This function generates the scales that will be used in the Continuous Wavelet Transform. 


\begin{DoxyParams}{Parameters}
{\em minimum\+\_\+frequency} & The lowest frequency that must be observed \\
\hline
{\em maximum\+\_\+frequency} & The higest frequency that must be observed \\
\hline
{\em s\+\_\+0} & The smallest scale usually it is $ 2 * \delta t $\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
scales An 1 x n array with the dyadic scales.
\end{DoxyReturn}
This function computes the dyadic scales to be generated to accurately compute the multi resolution analysis of a signal. Given the minimum frequency and the maximum frequency, the function will generate a 1 x n array with the scales necessary scale factors for the Continuous Wavelet Transform

The Scales array will be allocated in this function, so it is wise to deallocate this array after it is used. \hypertarget{wavelet_8h_a741383f7877b85635e4b9eaad57a11a1}{}\index{wavelet.\+h@{wavelet.\+h}!Identify\+Frequencies@{Identify\+Frequencies}}
\index{Identify\+Frequencies@{Identify\+Frequencies}!wavelet.\+h@{wavelet.\+h}}
\subsubsection[{Identify\+Frequencies(double $\ast$scales, int count)}]{\setlength{\rightskip}{0pt plus 5cm}double $\ast$ Identify\+Frequencies (
\begin{DoxyParamCaption}
\item[{double $\ast$}]{scales, }
\item[{int}]{count}
\end{DoxyParamCaption}
)}\label{wavelet_8h_a741383f7877b85635e4b9eaad57a11a1}


Compute the corrosponding frequency to scales used. 


\begin{DoxyParams}{Parameters}
{\em scales} & A 1 x count array of the scales used \\
\hline
{\em count} & The cardinal of the scales array\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
frequency The corrosponding frequency for each scale in the scale array
\end{DoxyReturn}
This function computes the corrosponding frequency for each scale provided in the scales array.

It allocates memory and returns the allocated array

It is wise to dealloate this array after use with the free() function. \hypertarget{wavelet_8h_aea1698ec0444b6a49c195c64c23dd2d5}{}\index{wavelet.\+h@{wavelet.\+h}!Read\+File@{Read\+File}}
\index{Read\+File@{Read\+File}!wavelet.\+h@{wavelet.\+h}}
\subsubsection[{Read\+File(double data[], char filename[])}]{\setlength{\rightskip}{0pt plus 5cm}int Read\+File (
\begin{DoxyParamCaption}
\item[{double}]{data\mbox{[}$\,$\mbox{]}, }
\item[{char}]{filename\mbox{[}$\,$\mbox{]}}
\end{DoxyParamCaption}
)}\label{wavelet_8h_aea1698ec0444b6a49c195c64c23dd2d5}

\begin{DoxyParams}{Parameters}
{\em A} & pre allocated 1 dimentional array \\
\hline
{\em filename} & The name and location of the file to be opened\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
array\+\_\+size The number of elements that was read
\end{DoxyReturn}
This function opens a file, and reads the input assuming that the file is stored with one value at every line. \hypertarget{wavelet_8h_ab48098090bc3958e58e44ebec4a63f52}{}\index{wavelet.\+h@{wavelet.\+h}!Test\+Cases@{Test\+Cases}}
\index{Test\+Cases@{Test\+Cases}!wavelet.\+h@{wavelet.\+h}}
\subsubsection[{Test\+Cases(double $\ast$data, const int flag)}]{\setlength{\rightskip}{0pt plus 5cm}void Test\+Cases (
\begin{DoxyParamCaption}
\item[{double $\ast$}]{data, }
\item[{int}]{flag}
\end{DoxyParamCaption}
)}\label{wavelet_8h_ab48098090bc3958e58e44ebec4a63f52}


Generates a suite of test case data for wavelet analysis. 


\begin{DoxyParams}{Parameters}
{\em data} & The 1 x n data array to be populated \\
\hline
{\em flag} & The type of test data to be generated\\
\hline
\end{DoxyParams}
This function populates the data array with 3 seconds of sample data. The {\itshape flag} parameter specifies the type of test data that will be generated

\begin{table}[h]\begin{TabularC}{2}
\hline
\rowcolor{lightgray}{\bf Flag Type }&{\bf Output }\\\cline{1-2}
1 &Impulse at T = 2 seconds \\\cline{1-2}
2 &2 Sine waves at t = 1.\+5 seconds at F\+R\+E\+Q and 2 $\ast$ F\+R\+E\+Q \\\cline{1-2}
3 &2 sine waves at F\+R\+E\+Q and 2 $\ast$ F\+R\+E\+Q from t = 0 to 3 s \\\cline{1-2}
4 &Single sine wave at t = 1.\+0 s \\\cline{1-2}
5 &sin(x) from t = 0.\+0 to 3.\+0 and 2$\ast$sin(x) from t = 1.\+5 -\/ 2.\+0 s \\\cline{1-2}
6 &sin(x) from t = 0.\+0 -\/ 3.\+0 and sin(x -\/ w0) where w0 = 0.\+005 from t = 1.\+0 s -\/ 1.\+5 s \\\cline{1-2}
7 &Frequency Sweet from M\+I\+N\+\_\+\+F\+R\+E\+Q\+U\+E\+N\+C\+Y to M\+A\+X\+\_\+\+F\+R\+E\+Q\+U\+E\+N\+C\+Y \\\cline{1-2}
\end{TabularC}
\centering
\caption{Test\+Cases Flags}
\end{table}
\hypertarget{wavelet_8h_ad5997a1e04e6726779fded8881045b7d}{}\index{wavelet.\+h@{wavelet.\+h}!Wavelet@{Wavelet}}
\index{Wavelet@{Wavelet}!wavelet.\+h@{wavelet.\+h}}
\subsubsection[{Wavelet(double $\ast$raw\+\_\+data, double $\ast$scales, double sampling\+\_\+frequency, int n, int J, double $\ast$result)}]{\setlength{\rightskip}{0pt plus 5cm}int Wavelet (
\begin{DoxyParamCaption}
\item[{double $\ast$}]{raw\+\_\+data, }
\item[{double $\ast$}]{scales, }
\item[{double}]{sampling\+\_\+frequency, }
\item[{int}]{n, }
\item[{int}]{J, }
\item[{double $\ast$}]{result}
\end{DoxyParamCaption}
)}\label{wavelet_8h_ad5997a1e04e6726779fded8881045b7d}


A function that computes the Continuous Wavelet Transform for the data given in {\itshape raw\+\_\+data}. 


\begin{DoxyParams}{Parameters}
{\em raw\+\_\+data} & A 1 x n array with the data required \\
\hline
{\em scales} & A 1 x J array with all of the scales for generating the wavelets \\
\hline
{\em sampling\+\_\+frequency} & The sampling frequency of the given data \\
\hline
{\em n} & The size of the input data \\
\hline
{\em J} & The number of scales that is provided \\
\hline
{\em result} & An n x J array of contiguous memory that stores the result\\
\hline
\end{DoxyParams}
This function preforms the Continuous Wavelet Transform using Morlet Wavelets on the data given in raw\+\_\+data. It stores the result in the result array.

This function only modifies the result array. The arrays must be pre allocated for this function to work.

You can provide the function with scales of your choosing, or one can generate dyadic scales with the \hyperlink{wavelet_8cc_a09c27fbf3c2f81918edd9c57169ca371}{Generate\+Scales()} function.

This function is optimized using openmp to allow for multi threading. \hypertarget{wavelet_8h_a03987d098ad4cf62c98501cf41969731}{}\index{wavelet.\+h@{wavelet.\+h}!Write\+Debug@{Write\+Debug}}
\index{Write\+Debug@{Write\+Debug}!wavelet.\+h@{wavelet.\+h}}
\subsubsection[{Write\+Debug(const double $\ast$data, const int length, const char $\ast$filename)}]{\setlength{\rightskip}{0pt plus 5cm}int Write\+Debug (
\begin{DoxyParamCaption}
\item[{const double $\ast$}]{data, }
\item[{const int}]{length, }
\item[{const char $\ast$}]{filename}
\end{DoxyParamCaption}
)}\label{wavelet_8h_a03987d098ad4cf62c98501cf41969731}


A function that writes a 1 -\/ d matrix into a log file. 


\begin{DoxyParams}{Parameters}
{\em data} & A 1 -\/ dimentional data array containing the data to be written \\
\hline
{\em length} & The size of the data array \\
\hline
{\em filename} & T\+He name of the file to be written\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if successful 

-\/1 if unsuccessful
\end{DoxyReturn}
This function writes a 1 -\/ dimentional array to the disk, it\textquotesingle{}s useful when trying to quickly get the results from an array. \hypertarget{wavelet_8h_a523cfb0453d4d7201a7ecf209f951ad5}{}\index{wavelet.\+h@{wavelet.\+h}!Write\+File@{Write\+File}}
\index{Write\+File@{Write\+File}!wavelet.\+h@{wavelet.\+h}}
\subsubsection[{Write\+File(const double $\ast$data, const double $\ast$frequency, const int x, const int y, const char $\ast$filename)}]{\setlength{\rightskip}{0pt plus 5cm}int Write\+File (
\begin{DoxyParamCaption}
\item[{const double $\ast$}]{data, }
\item[{const double $\ast$}]{period, }
\item[{const int}]{x, }
\item[{const int}]{y, }
\item[{const char $\ast$}]{filename}
\end{DoxyParamCaption}
)}\label{wavelet_8h_a523cfb0453d4d7201a7ecf209f951ad5}


A function that writes the Wavelet Results to the disk. 


\begin{DoxyParams}{Parameters}
{\em data} & A x x y array with the data that is going to be written \\
\hline
{\em period} & A 1 x y array with the frequencies that were analyzed \\
\hline
{\em x} & The number of samples in the signal \\
\hline
{\em y} & The number of frequencies analyzed \\
\hline
{\em filename} & The name of the file that will be written\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if successful 

-\/1 if unsuccessful
\end{DoxyReturn}
This function will write the resultant data computed by \hyperlink{wavelet_8cc_ad5997a1e04e6726779fded8881045b7d}{Wavelet()} and \hyperlink{wavelet_8h_afd3b9cec11d036982bf9ab02c05c05b2}{E\+R\+S\+P()} into the disk so that it can be graphed by Gnuplot. One can plot the output of this function using the matrix.\+gplot file. 