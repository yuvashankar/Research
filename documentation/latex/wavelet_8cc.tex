\hypertarget{wavelet_8cc}{}\section{/\+Users/vinay/\+Google Drive/\+Science/\+Research/\+Morlets/wavelet.cc File Reference}
\label{wavelet_8cc}\index{/\+Users/vinay/\+Google Drive/\+Science/\+Research/\+Morlets/wavelet.\+cc@{/\+Users/vinay/\+Google Drive/\+Science/\+Research/\+Morlets/wavelet.\+cc}}


This file contains all of the functions that support the E\+R\+S\+P and C\+W\+T functions.  


{\ttfamily \#include \char`\"{}wavelet.\+h\char`\"{}}\\*
{\ttfamily \#include $<$omp.\+h$>$}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\hypertarget{wavelet_8cc_ab946e2e7f7679350627acfded8e2658b}{}\#define {\bfseries T\+E\+S\+T}~0.\+00001\label{wavelet_8cc_ab946e2e7f7679350627acfded8e2658b}

\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{wavelet_8cc_ad5997a1e04e6726779fded8881045b7d}{Wavelet} (double $\ast$raw\+\_\+data, double $\ast$scales, double sampling\+\_\+frequency, int n, int J, double $\ast$result)
\begin{DoxyCompactList}\small\item\em A function that computes the Continuous Wavelet Transform for the data given in {\itshape raw\+\_\+data}. \end{DoxyCompactList}\item 
int \hyperlink{wavelet_8cc_ab7b8e80239255476283ace667b26e46b}{Calculate\+Padding\+Size} (const int array\+\_\+size, const int pad\+\_\+flag)
\begin{DoxyCompactList}\small\item\em Calculates the size that the padded array should be. \end{DoxyCompactList}\item 
double $\ast$ \hyperlink{wavelet_8cc_a09c27fbf3c2f81918edd9c57169ca371}{Generate\+Scales} (const double minimum\+\_\+frequency, const double maximum\+\_\+frequency, const double s\+\_\+0)
\begin{DoxyCompactList}\small\item\em This function generates the scales that will be used in the Continuous Wavelet Transform. \end{DoxyCompactList}\item 
double $\ast$ \hyperlink{wavelet_8cc_a27394bc7ac779d93a58fa1a8e2230337}{Identify\+Frequencies} (double $\ast$scales, int count)
\begin{DoxyCompactList}\small\item\em Compute the corrosponding frequency to scales used. \end{DoxyCompactList}\item 
double \hyperlink{wavelet_8cc_abb362e505564f730823d539a93d31de2}{Complete\+Fourier\+Morlet} (const double w, const double scale)
\begin{DoxyCompactList}\small\item\em Computes the Morlet Wavelet in the frequency domain. \end{DoxyCompactList}\item 
void \hyperlink{wavelet_8cc_ab48098090bc3958e58e44ebec4a63f52}{Test\+Cases} (double $\ast$data, const int flag)
\begin{DoxyCompactList}\small\item\em Generates a suite of test case data for wavelet analysis. \end{DoxyCompactList}\item 
int \hyperlink{wavelet_8cc_a523cfb0453d4d7201a7ecf209f951ad5}{Write\+File} (const double $\ast$data, const double $\ast$frequency, const int x, const int y, const char $\ast$filename)
\begin{DoxyCompactList}\small\item\em A function that writes the Wavelet Results to the disk. \end{DoxyCompactList}\item 
int \hyperlink{wavelet_8cc_a03987d098ad4cf62c98501cf41969731}{Write\+Debug} (const double $\ast$data, const int length, const char $\ast$filename)
\begin{DoxyCompactList}\small\item\em A function that writes a 1 -\/ d matrix into a log file. \end{DoxyCompactList}\item 
void \hyperlink{wavelet_8cc_a7f77d41dda595606800244954e79daad}{Fill\+Data} (double $\ast$data)
\begin{DoxyCompactList}\small\item\em Populates the input data array with a 3 sparse sine waves. \end{DoxyCompactList}\item 
int \hyperlink{wavelet_8cc_aea1698ec0444b6a49c195c64c23dd2d5}{Read\+File} (double data\mbox{[}$\,$\mbox{]}, char filename\mbox{[}$\,$\mbox{]})
\end{DoxyCompactItemize}


\subsection{Detailed Description}
This file contains all of the functions that support the E\+R\+S\+P and C\+W\+T functions. 



\subsection{Function Documentation}
\hypertarget{wavelet_8cc_ab7b8e80239255476283ace667b26e46b}{}\index{wavelet.\+cc@{wavelet.\+cc}!Calculate\+Padding\+Size@{Calculate\+Padding\+Size}}
\index{Calculate\+Padding\+Size@{Calculate\+Padding\+Size}!wavelet.\+cc@{wavelet.\+cc}}
\subsubsection[{Calculate\+Padding\+Size(const int array\+\_\+size, const int pad\+\_\+flag)}]{\setlength{\rightskip}{0pt plus 5cm}int Calculate\+Padding\+Size (
\begin{DoxyParamCaption}
\item[{const int}]{array\+\_\+size, }
\item[{const int}]{pad\+\_\+flag}
\end{DoxyParamCaption}
)}\label{wavelet_8cc_ab7b8e80239255476283ace667b26e46b}


Calculates the size that the padded array should be. 


\begin{DoxyParams}{Parameters}
{\em array\+\_\+size} & The cardinal or size of the signal sample \\
\hline
{\em pad\+\_\+flag} & The type of padding required\+: see P\+A\+D\+\_\+\+F\+L\+A\+G\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
paadded\+\_\+size The cardinal or size that the padded array should be
\end{DoxyReturn}
This function computes the size of the padded array depending on the type of padding specified. It takes the size of the data array, and type of pad, and returns how large the padded array should be. \hypertarget{wavelet_8cc_abb362e505564f730823d539a93d31de2}{}\index{wavelet.\+cc@{wavelet.\+cc}!Complete\+Fourier\+Morlet@{Complete\+Fourier\+Morlet}}
\index{Complete\+Fourier\+Morlet@{Complete\+Fourier\+Morlet}!wavelet.\+cc@{wavelet.\+cc}}
\subsubsection[{Complete\+Fourier\+Morlet(const double w, const double scale)}]{\setlength{\rightskip}{0pt plus 5cm}double Complete\+Fourier\+Morlet (
\begin{DoxyParamCaption}
\item[{const double}]{w, }
\item[{const double}]{scale}
\end{DoxyParamCaption}
)}\label{wavelet_8cc_abb362e505564f730823d539a93d31de2}


Computes the Morlet Wavelet in the frequency domain. 


\begin{DoxyParams}{Parameters}
{\em w} & \\
\hline
{\em scale} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
morlet
\end{DoxyReturn}
This function generates the Morlet Wavelet in the frequency domain normalized by the scale.

The formula computed is \[ \hat{\Psi}_\sigma(\omega) = c_\sigma \pi^{-\frac{1}{4}}(e^{-\frac{1}{2}(\sigma - \omega)^2} - \kappa_\sigma e^{-\frac{1}{2} \omega^2}) \] \hypertarget{wavelet_8cc_a7f77d41dda595606800244954e79daad}{}\index{wavelet.\+cc@{wavelet.\+cc}!Fill\+Data@{Fill\+Data}}
\index{Fill\+Data@{Fill\+Data}!wavelet.\+cc@{wavelet.\+cc}}
\subsubsection[{Fill\+Data(double $\ast$data)}]{\setlength{\rightskip}{0pt plus 5cm}void Fill\+Data (
\begin{DoxyParamCaption}
\item[{double $\ast$}]{data}
\end{DoxyParamCaption}
)}\label{wavelet_8cc_a7f77d41dda595606800244954e79daad}


Populates the input data array with a 3 sparse sine waves. 


\begin{DoxyParams}{Parameters}
{\em data} & A 1 -\/ dimentional block of memory that will be overwritten.\\
\hline
\end{DoxyParams}
Similar to \hyperlink{wavelet_8cc_ab48098090bc3958e58e44ebec4a63f52}{Test\+Cases()} Sine Wave Sample

Sine Wave Sample \hypertarget{wavelet_8cc_a09c27fbf3c2f81918edd9c57169ca371}{}\index{wavelet.\+cc@{wavelet.\+cc}!Generate\+Scales@{Generate\+Scales}}
\index{Generate\+Scales@{Generate\+Scales}!wavelet.\+cc@{wavelet.\+cc}}
\subsubsection[{Generate\+Scales(const double minimum\+\_\+frequency, const double maximum\+\_\+frequency, const double s\+\_\+0)}]{\setlength{\rightskip}{0pt plus 5cm}double$\ast$ Generate\+Scales (
\begin{DoxyParamCaption}
\item[{const double}]{minimum\+\_\+frequency, }
\item[{const double}]{maximum\+\_\+frequency, }
\item[{const double}]{s\+\_\+0}
\end{DoxyParamCaption}
)}\label{wavelet_8cc_a09c27fbf3c2f81918edd9c57169ca371}


This function generates the scales that will be used in the Continuous Wavelet Transform. 


\begin{DoxyParams}{Parameters}
{\em minimum\+\_\+frequency} & The lowest frequency that must be observed \\
\hline
{\em maximum\+\_\+frequency} & The higest frequency that must be observed \\
\hline
{\em s\+\_\+0} & The smallest scale usually it is $ 2 * \delta t $\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
scales An 1 x n array with the dyadic scales.
\end{DoxyReturn}
This function computes the dyadic scales to be generated to accurately compute the multi resolution analysis of a signal. Given the minimum frequency and the maximum frequency, the function will generate a 1 x n array with the scales necessary scale factors for the Continuous Wavelet Transform

The Scales array will be allocated in this function, so it is wise to deallocate this array after it is used. \hypertarget{wavelet_8cc_a27394bc7ac779d93a58fa1a8e2230337}{}\index{wavelet.\+cc@{wavelet.\+cc}!Identify\+Frequencies@{Identify\+Frequencies}}
\index{Identify\+Frequencies@{Identify\+Frequencies}!wavelet.\+cc@{wavelet.\+cc}}
\subsubsection[{Identify\+Frequencies(double $\ast$scales, int count)}]{\setlength{\rightskip}{0pt plus 5cm}double$\ast$ Identify\+Frequencies (
\begin{DoxyParamCaption}
\item[{double $\ast$}]{scales, }
\item[{int}]{count}
\end{DoxyParamCaption}
)}\label{wavelet_8cc_a27394bc7ac779d93a58fa1a8e2230337}


Compute the corrosponding frequency to scales used. 


\begin{DoxyParams}{Parameters}
{\em scales} & A 1 x count array of the scales used \\
\hline
{\em count} & The cardinal of the scales array\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
frequency The corrosponding frequency for each scale in the scale array
\end{DoxyReturn}
This function computes the corrosponding frequency for each scale provided in the scales array.

It allocates memory and returns the allocated array

It is wise to dealloate this array after use with the free() function. \hypertarget{wavelet_8cc_aea1698ec0444b6a49c195c64c23dd2d5}{}\index{wavelet.\+cc@{wavelet.\+cc}!Read\+File@{Read\+File}}
\index{Read\+File@{Read\+File}!wavelet.\+cc@{wavelet.\+cc}}
\subsubsection[{Read\+File(double data[], char filename[])}]{\setlength{\rightskip}{0pt plus 5cm}int Read\+File (
\begin{DoxyParamCaption}
\item[{double}]{data\mbox{[}$\,$\mbox{]}, }
\item[{char}]{filename\mbox{[}$\,$\mbox{]}}
\end{DoxyParamCaption}
)}\label{wavelet_8cc_aea1698ec0444b6a49c195c64c23dd2d5}

\begin{DoxyParams}{Parameters}
{\em A} & pre allocated 1 dimentional array \\
\hline
{\em filename} & The name and location of the file to be opened\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
array\+\_\+size The number of elements that was read
\end{DoxyReturn}
This function opens a file, and reads the input assuming that the file is stored with one value at every line. \hypertarget{wavelet_8cc_ab48098090bc3958e58e44ebec4a63f52}{}\index{wavelet.\+cc@{wavelet.\+cc}!Test\+Cases@{Test\+Cases}}
\index{Test\+Cases@{Test\+Cases}!wavelet.\+cc@{wavelet.\+cc}}
\subsubsection[{Test\+Cases(double $\ast$data, const int flag)}]{\setlength{\rightskip}{0pt plus 5cm}void Test\+Cases (
\begin{DoxyParamCaption}
\item[{double $\ast$}]{data, }
\item[{const int}]{flag}
\end{DoxyParamCaption}
)}\label{wavelet_8cc_ab48098090bc3958e58e44ebec4a63f52}


Generates a suite of test case data for wavelet analysis. 


\begin{DoxyParams}{Parameters}
{\em data} & The 1 x n data array to be populated \\
\hline
{\em flag} & The type of test data to be generated\\
\hline
\end{DoxyParams}
This function populates the data array with 3 seconds of sample data. The {\itshape flag} parameter specifies the type of test data that will be generated

\begin{table}[h]\begin{TabularC}{2}
\hline
\rowcolor{lightgray}{\bf Flag Type }&{\bf Output }\\\cline{1-2}
1 &Impulse at T = 2 seconds \\\cline{1-2}
2 &2 Sine waves at t = 1.\+5 seconds at F\+R\+E\+Q and 2 $\ast$ F\+R\+E\+Q \\\cline{1-2}
3 &2 sine waves at F\+R\+E\+Q and 2 $\ast$ F\+R\+E\+Q from t = 0 to 3 s \\\cline{1-2}
4 &Single sine wave at t = 1.\+0 s \\\cline{1-2}
5 &sin(x) from t = 0.\+0 to 3.\+0 and 2$\ast$sin(x) from t = 1.\+5 -\/ 2.\+0 s \\\cline{1-2}
6 &sin(x) from t = 0.\+0 -\/ 3.\+0 and sin(x -\/ w0) where w0 = 0.\+005 from t = 1.\+0 s -\/ 1.\+5 s \\\cline{1-2}
7 &Frequency Sweet from M\+I\+N\+\_\+\+F\+R\+E\+Q\+U\+E\+N\+C\+Y to M\+A\+X\+\_\+\+F\+R\+E\+Q\+U\+E\+N\+C\+Y \\\cline{1-2}
\end{TabularC}
\centering
\caption{Test\+Cases Flags}
\end{table}
\hypertarget{wavelet_8cc_ad5997a1e04e6726779fded8881045b7d}{}\index{wavelet.\+cc@{wavelet.\+cc}!Wavelet@{Wavelet}}
\index{Wavelet@{Wavelet}!wavelet.\+cc@{wavelet.\+cc}}
\subsubsection[{Wavelet(double $\ast$raw\+\_\+data, double $\ast$scales, double sampling\+\_\+frequency, int n, int J, double $\ast$result)}]{\setlength{\rightskip}{0pt plus 5cm}int Wavelet (
\begin{DoxyParamCaption}
\item[{double $\ast$}]{raw\+\_\+data, }
\item[{double $\ast$}]{scales, }
\item[{double}]{sampling\+\_\+frequency, }
\item[{int}]{n, }
\item[{int}]{J, }
\item[{double $\ast$}]{result}
\end{DoxyParamCaption}
)}\label{wavelet_8cc_ad5997a1e04e6726779fded8881045b7d}


A function that computes the Continuous Wavelet Transform for the data given in {\itshape raw\+\_\+data}. 


\begin{DoxyParams}{Parameters}
{\em raw\+\_\+data} & A 1 x n array with the data required \\
\hline
{\em scales} & A 1 x J array with all of the scales for generating the wavelets \\
\hline
{\em sampling\+\_\+frequency} & The sampling frequency of the given data \\
\hline
{\em n} & The size of the input data \\
\hline
{\em J} & The number of scales that is provided \\
\hline
{\em result} & An n x J array of contiguous memory that stores the result\\
\hline
\end{DoxyParams}
This function preforms the Continuous Wavelet Transform using Morlet Wavelets on the data given in raw\+\_\+data. It stores the result in the result array.

This function only modifies the result array. The arrays must be pre allocated for this function to work.

You can provide the function with scales of your choosing, or one can generate dyadic scales with the \hyperlink{wavelet_8cc_a09c27fbf3c2f81918edd9c57169ca371}{Generate\+Scales()} function.

This function is optimized using openmp to allow for multi threading. \hypertarget{wavelet_8cc_a03987d098ad4cf62c98501cf41969731}{}\index{wavelet.\+cc@{wavelet.\+cc}!Write\+Debug@{Write\+Debug}}
\index{Write\+Debug@{Write\+Debug}!wavelet.\+cc@{wavelet.\+cc}}
\subsubsection[{Write\+Debug(const double $\ast$data, const int length, const char $\ast$filename)}]{\setlength{\rightskip}{0pt plus 5cm}int Write\+Debug (
\begin{DoxyParamCaption}
\item[{const double $\ast$}]{data, }
\item[{const int}]{length, }
\item[{const char $\ast$}]{filename}
\end{DoxyParamCaption}
)}\label{wavelet_8cc_a03987d098ad4cf62c98501cf41969731}


A function that writes a 1 -\/ d matrix into a log file. 


\begin{DoxyParams}{Parameters}
{\em data} & A 1 -\/ dimentional data array containing the data to be written \\
\hline
{\em length} & The size of the data array \\
\hline
{\em filename} & T\+He name of the file to be written\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if successful 

-\/1 if unsuccessful
\end{DoxyReturn}
This function writes a 1 -\/ dimentional array to the disk, it\textquotesingle{}s useful when trying to quickly get the results from an array. \hypertarget{wavelet_8cc_a523cfb0453d4d7201a7ecf209f951ad5}{}\index{wavelet.\+cc@{wavelet.\+cc}!Write\+File@{Write\+File}}
\index{Write\+File@{Write\+File}!wavelet.\+cc@{wavelet.\+cc}}
\subsubsection[{Write\+File(const double $\ast$data, const double $\ast$frequency, const int x, const int y, const char $\ast$filename)}]{\setlength{\rightskip}{0pt plus 5cm}int Write\+File (
\begin{DoxyParamCaption}
\item[{const double $\ast$}]{data, }
\item[{const double $\ast$}]{frequency, }
\item[{const int}]{x, }
\item[{const int}]{y, }
\item[{const char $\ast$}]{filename}
\end{DoxyParamCaption}
)}\label{wavelet_8cc_a523cfb0453d4d7201a7ecf209f951ad5}


A function that writes the Wavelet Results to the disk. 


\begin{DoxyParams}{Parameters}
{\em data} & A x x y array with the data that is going to be written \\
\hline
{\em period} & A 1 x y array with the frequencies that were analyzed \\
\hline
{\em x} & The number of samples in the signal \\
\hline
{\em y} & The number of frequencies analyzed \\
\hline
{\em filename} & The name of the file that will be written\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if successful 

-\/1 if unsuccessful
\end{DoxyReturn}
This function will write the resultant data computed by \hyperlink{wavelet_8cc_ad5997a1e04e6726779fded8881045b7d}{Wavelet()} and \hyperlink{wavelet_8h_afd3b9cec11d036982bf9ab02c05c05b2}{E\+R\+S\+P()} into the disk so that it can be graphed by Gnuplot. One can plot the output of this function using the matrix.\+gplot file. 