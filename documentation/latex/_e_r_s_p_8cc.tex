\hypertarget{_e_r_s_p_8cc}{}\section{/\+Users/vinay/\+Google Drive/\+Science/\+Research/\+Morlets/\+E\+R\+S\+P.cc File Reference}
\label{_e_r_s_p_8cc}\index{/\+Users/vinay/\+Google Drive/\+Science/\+Research/\+Morlets/\+E\+R\+S\+P.\+cc@{/\+Users/vinay/\+Google Drive/\+Science/\+Research/\+Morlets/\+E\+R\+S\+P.\+cc}}


This file contains all of the function required to generate the Event Related Spectral Pertubation of E\+E\+G signals.  


{\ttfamily \#include \char`\"{}process\+E\+E\+G.\+h\char`\"{}}\\*
{\ttfamily \#include $<$gsl/gsl\+\_\+statistics.\+h$>$}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{_e_r_s_p_8cc_aa014a2e424ce6a16f9c9984422deb2cf}{Remove\+Baseline} (double $\ast$pre\+\_\+stimulus, double $\ast$pre\+\_\+baseline\+\_\+array, const int n, const int J, const int sampling\+\_\+frequency, double $\ast$output)
\begin{DoxyCompactList}\small\item\em A function that removes the pre stimulus noise found in E\+E\+G signals. \end{DoxyCompactList}\item 
int \hyperlink{_e_r_s_p_8cc_ac62979f131d715929fee642852d92469}{Frequency\+Multiply} (const fftw\+\_\+complex $\ast$fft\+\_\+data, const int data\+\_\+size, const double scale, const double dw, fftw\+\_\+complex $\ast$filter\+\_\+convolution)
\begin{DoxyCompactList}\small\item\em Multiples the signal with the wavelet at a specific scale in the frequency domain. \end{DoxyCompactList}\item 
\hypertarget{_e_r_s_p_8cc_a580cbd5e5094a8596715a0f5148a153c}{}int {\bfseries Populate\+Data\+Array} (double $\ast$input\+\_\+data, const int data\+\_\+size, const int trial\+\_\+number, const int padded\+\_\+size, const int padding\+\_\+type, fftw\+\_\+complex $\ast$output\+\_\+data)\label{_e_r_s_p_8cc_a580cbd5e5094a8596715a0f5148a153c}

\item 
int \hyperlink{_e_r_s_p_8cc_afd3b9cec11d036982bf9ab02c05c05b2}{E\+R\+S\+P} (double $\ast$raw\+\_\+data, double $\ast$scales, const int sampling\+\_\+frequency, const int n, const int J, int const trials, const int padding\+\_\+type, double $\ast$output)
\item 
int \hyperlink{_e_r_s_p_8cc_a0a80fcc210f38e5dd27c37426c0a5b16}{Generate\+\_\+\+F\+F\+T\+W\+\_\+\+Wisdom} (int padded\+\_\+size)
\begin{DoxyCompactList}\small\item\em Analyzes the size of the F\+F\+T\+W arrays and generates the optimal plan. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
This file contains all of the function required to generate the Event Related Spectral Pertubation of E\+E\+G signals. 



\subsection{Function Documentation}
\hypertarget{_e_r_s_p_8cc_afd3b9cec11d036982bf9ab02c05c05b2}{}\index{E\+R\+S\+P.\+cc@{E\+R\+S\+P.\+cc}!E\+R\+S\+P@{E\+R\+S\+P}}
\index{E\+R\+S\+P@{E\+R\+S\+P}!E\+R\+S\+P.\+cc@{E\+R\+S\+P.\+cc}}
\subsubsection[{E\+R\+S\+P(double $\ast$raw\+\_\+data, double $\ast$scales, const int sampling\+\_\+frequency, const int n, const int J, int const trials, const int padding\+\_\+type, double $\ast$output)}]{\setlength{\rightskip}{0pt plus 5cm}int E\+R\+S\+P (
\begin{DoxyParamCaption}
\item[{double $\ast$}]{raw\+\_\+data, }
\item[{double $\ast$}]{scales, }
\item[{const int}]{sampling\+\_\+frequency, }
\item[{const int}]{n, }
\item[{const int}]{J, }
\item[{int const}]{trials, }
\item[{const int}]{padding\+\_\+type, }
\item[{double $\ast$}]{output}
\end{DoxyParamCaption}
)}\label{_e_r_s_p_8cc_afd3b9cec11d036982bf9ab02c05c05b2}

\begin{DoxyParams}{Parameters}
{\em raw\+\_\+data} & A trials $\ast$ n array containing the data to be analyzed \\
\hline
{\em scales} & A 1 x J array of the scales that the wavelets will be analyzed in \\
\hline
{\em sampling\+\_\+frequency} & The frequency that the data was sampled in \\
\hline
{\em n} & The numer of samples in each data set \\
\hline
{\em J} & The number of scales to be analyzed \\
\hline
{\em trials} & The number of trials conducted for the E\+R\+S\+P \\
\hline
{\em output} & A n x J array with the resultant E\+R\+S\+P from all of the trials.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
This function conducts the Event Related Spectral Pertubation of the given data set {\itshape raw\+\_\+data}. It follows the method outlined by the paper\+: \char`\"{}\+Single-\/trial normalization for event-\/related spectral decomposition reduces sensitivity to noisy trials\char`\"{}.

This function uses the Continuous Wavelet Transform to generate the multi-\/resolution analysis of the given data.

This function is multi-\/threaded.

This function deals a lot with Fast Fourier Transforms, and can be optimized by using the Generate\+\_\+\+F\+F\+T\+W\+\_\+\+Wisedom() function. If no wisdom is provided, an approximate F\+F\+T algorithm will be used.

The variable raw\+\_\+data must contain all of the data for each trial.

raw\+\_\+data, scales, and output must be pre-\/allocated. \hypertarget{_e_r_s_p_8cc_ac62979f131d715929fee642852d92469}{}\index{E\+R\+S\+P.\+cc@{E\+R\+S\+P.\+cc}!Frequency\+Multiply@{Frequency\+Multiply}}
\index{Frequency\+Multiply@{Frequency\+Multiply}!E\+R\+S\+P.\+cc@{E\+R\+S\+P.\+cc}}
\subsubsection[{Frequency\+Multiply(const fftw\+\_\+complex $\ast$fft\+\_\+data, const int data\+\_\+size, const double scale, const double dw, fftw\+\_\+complex $\ast$filter\+\_\+convolution)}]{\setlength{\rightskip}{0pt plus 5cm}int Frequency\+Multiply (
\begin{DoxyParamCaption}
\item[{const fftw\+\_\+complex $\ast$}]{fft\+\_\+data, }
\item[{const int}]{data\+\_\+size, }
\item[{const double}]{scale, }
\item[{const double}]{dw, }
\item[{fftw\+\_\+complex $\ast$}]{filter\+\_\+convolution}
\end{DoxyParamCaption}
)}\label{_e_r_s_p_8cc_ac62979f131d715929fee642852d92469}


Multiples the signal with the wavelet at a specific scale in the frequency domain. 


\begin{DoxyParams}{Parameters}
{\em fft\+\_\+data} & A fftw\+\_\+complex $\ast$ data\+\_\+size array with the signal data in the frequency domain. \\
\hline
{\em data\+\_\+size} & The size of the data array \\
\hline
{\em scale} & T\+He scale of the wavelet that will be multiplied with the signal array \\
\hline
{\em dw} & T\+He discrete increment in the frequency domain for the wavelet \\
\hline
{\em filter\+\_\+convolution} & A fftw\+\_\+complex $\ast$ data\+\_\+size array with the resulted multiplication\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
This function mutliples the contents of fft\+\_\+data with with the wavelet specified by the variable {\itshape scale}. It stores the result in filter\+\_\+convolution.

All arrays must be pre allocated. \hypertarget{_e_r_s_p_8cc_a0a80fcc210f38e5dd27c37426c0a5b16}{}\index{E\+R\+S\+P.\+cc@{E\+R\+S\+P.\+cc}!Generate\+\_\+\+F\+F\+T\+W\+\_\+\+Wisdom@{Generate\+\_\+\+F\+F\+T\+W\+\_\+\+Wisdom}}
\index{Generate\+\_\+\+F\+F\+T\+W\+\_\+\+Wisdom@{Generate\+\_\+\+F\+F\+T\+W\+\_\+\+Wisdom}!E\+R\+S\+P.\+cc@{E\+R\+S\+P.\+cc}}
\subsubsection[{Generate\+\_\+\+F\+F\+T\+W\+\_\+\+Wisdom(int padded\+\_\+size)}]{\setlength{\rightskip}{0pt plus 5cm}int Generate\+\_\+\+F\+F\+T\+W\+\_\+\+Wisdom (
\begin{DoxyParamCaption}
\item[{int}]{padded\+\_\+size}
\end{DoxyParamCaption}
)}\label{_e_r_s_p_8cc_a0a80fcc210f38e5dd27c37426c0a5b16}


Analyzes the size of the F\+F\+T\+W arrays and generates the optimal plan. 


\begin{DoxyParams}{Parameters}
{\em padded\+\_\+size} & The size of the F\+F\+T arrays.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 If successful 

1 if unsuccessful
\end{DoxyReturn}
This function can be used to optimize F\+F\+T\+W. This function will try to find the fastest F\+F\+T method based on the size of the array, and will store this information as \char`\"{}\+F\+F\+T\+W\+\_\+plan.\+wise\char`\"{}.

This function does not need to be used, but it can significantly improve performance if it is. \hypertarget{_e_r_s_p_8cc_aa014a2e424ce6a16f9c9984422deb2cf}{}\index{E\+R\+S\+P.\+cc@{E\+R\+S\+P.\+cc}!Remove\+Baseline@{Remove\+Baseline}}
\index{Remove\+Baseline@{Remove\+Baseline}!E\+R\+S\+P.\+cc@{E\+R\+S\+P.\+cc}}
\subsubsection[{Remove\+Baseline(double $\ast$pre\+\_\+stimulus, double $\ast$pre\+\_\+baseline\+\_\+array, const int n, const int J, const int sampling\+\_\+frequency, double $\ast$output)}]{\setlength{\rightskip}{0pt plus 5cm}int Remove\+Baseline (
\begin{DoxyParamCaption}
\item[{double $\ast$}]{pre\+\_\+stimulus, }
\item[{double $\ast$}]{pre\+\_\+baseline\+\_\+array, }
\item[{const int}]{n, }
\item[{const int}]{J, }
\item[{const int}]{m, }
\item[{double $\ast$}]{output}
\end{DoxyParamCaption}
)}\label{_e_r_s_p_8cc_aa014a2e424ce6a16f9c9984422deb2cf}


A function that removes the pre stimulus noise found in E\+E\+G signals. 


\begin{DoxyParams}{Parameters}
{\em pre\+\_\+stimulus} & A 1 x m array to store the pre stimulus data \\
\hline
{\em pre\+\_\+baseline\+\_\+array} & An n x J array of the data that must be modified \\
\hline
{\em n} & The number of samples in the entire data array \\
\hline
{\em J} & The number of scales that were used \\
\hline
{\em m} & The size of the array before the stimulus \\
\hline
{\em output} & An n x J array that the function stores the result in.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0
\end{DoxyReturn}
This function follows the method outlined in the paper \char`\"{}\+Single-\/trial normalization for event-\/related spectral decomposition reduces sensitivity to noisy trials\char`\"{}.

The function will remove the baseline observed in in the pre stimulus by computing the z score on only the information before the stimulus. The variable {\itshape m} is the number of samples before the stimulus was introduced.

All arrays must be pre allocated. 